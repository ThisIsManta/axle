<html>
	<head>
		<title>Axle</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
		<link href="https://fonts.googleapis.com/css?family=Roboto+Mono:100,500" rel="stylesheet">
		<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' />
	</head>
	<body style="background: black; margin: 0; color: white; font-size: 35vh; font-family: 'Roboto Mono', monospace; font-weight: 500; user-select: none; transition: background-color 0.3s ease-out">
		<div class="timer top" style="height: 50%; display: flex; align-items: center; justify-content: center; background: linear-gradient(#00000020, transparent, transparent, transparent, transparent); transform: rotate(180deg);"></div>
		<div class="timer btm" style="height: 50%; display: flex; align-items: center; justify-content: center;"></div>
		<script>
			const tickSound = new Audio('./tick.wav')
			const beepSound = new Audio('./beep.wav')
			const deadSound = new Audio('./dead.wav')

			const options = window.location.search.substring(1).split('&')

			let count = parseInt(window.location.hash.substring(1) || '15')
			let value = count
			let timer = null

			function paint() {
				const m = Math.floor(value / 60)
				const s = value % 60
				$('.timer').html(value >= 60 ? (m + '' + `<span style="font-weight: 100;">${String(s).padStart(2, '0')}</span>`) : s)
			}
			paint()

			$(window).on('click', () => {
				clearInterval(timer)
				pushSound()
				$('body').css({ background: 'lime', color: 'black' })

				value = count
				paint()

				timer = setInterval(() => {
					value -= 1
					paint()

					if (value === 0) {
						deadSound.play()
						clearInterval(timer)
						timer = null
					} else if (value <= 5) {
						$('body').css({ background: 'red', color: 'white' })
						beepSound.play()
					} else if (value <= 60 ? (value % 2 === 0) : (value % 5 === 0)) {
						tickSound.play()
					}

				}, 1000)
			})

			$(window).on('dblclick', () => {
				clearInterval(timer)
				timer = null

				value = count
				paint()
				$('body').css({ background: 'black', color: 'white' })
			})

			$(window).on('contextmenu', e => {
				e.preventDefault()

				document.documentElement.requestFullscreen()
			})

			const soundList = {
				'': new Audio('./button-29.wav'),
				car: new Audio('./car-locked-honk-01.wav'),
				gun: new Audio('./gun-gunshot-01.wav'),
				fun: [
					new Audio('./fart-01.wav'),
					new Audio('./fart-03.wav'),
					new Audio('./fart-06.wav'),
					new Audio('./burp-01.wav'),
					new Audio('./man-scream-01.wav'),
					new Audio('./woman-scream-02.wav'),
				]
			}

			function pushSound() {
				const sound = soundList[options.find(option => soundList[option]) || '']
				if (Array.isArray(sound)) {
					sound[Math.ceil(Math.random() * sound.length) - 1].play()
				} else {
					sound.play()
				}
			}
		</script>
	</body>
</html>